<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resizable Circles</title>
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #f0f0f0;
        margin: 0;
    }
    #circle-container {
        position: relative;
        width: 100%;
        max-width: 500px;
        height: 100%;
        max-height: 500px;
        aspect-ratio: 1;
        border: 1px solid #ccc;
        background-color: #fff;
    }
    .circle {
        position: absolute;
        border-radius: 50%;
        cursor: pointer;
        user-select: none;
    }
    #circle-red {
        width: 20%;
        height: 20%;
        top: 20%;
        left: 50%;
        background-color: red;
    }
    #circle-blue {
        width: 20%;
        height: 20%;
        top: 50%;
        left: 20%;
        background-color: blue;
    }
    #circle-green {
        width: 20%;
        height: 20%;
        top: 50%;
        left: 60%;
        background-color: green;
    }
</style>
</head>
<body>

<div id="circle-container">
    <div id="circle-red" class="circle"></div>
    <div id="circle-blue" class="circle"></div>
    <div id="circle-green" class="circle"></div>
</div>

<script>
    let selectedCircle = null;
    let startY = 0;
    let startSize = 0;

    // Function to start resizing the circle
    function onMouseDown(event) {
        if (event.button !== 0) return; // Only respond to left mouse button
        selectedCircle = event.target;
        startY = event.clientY;
        startSize = parseFloat(selectedCircle.style.width);
        selectedCircle.style.border = "2px dashed yellow";
        window.addEventListener("mousemove", onMouseMove);
        window.addEventListener("mouseup", onMouseUp);
        event.preventDefault();
    }

    // Function to resize the circle
    function onMouseMove(event) {
        if (!selectedCircle) return;
        const dy = event.clientY - startY;
        const newSize = Math.max(10, startSize + (dy / window.innerHeight) * 100);
        selectedCircle.style.width = `${newSize}%`;
        selectedCircle.style.height = `${newSize}%`;
    }

    // Function to end resizing and send data back to Qualtrics
    function onMouseUp() {
        if (!selectedCircle) return;
        selectedCircle.style.border = "none";

        const container = document.getElementById("circle-container");
        const redRadius = (parseFloat(document.getElementById("circle-red").style.width) / 100) * container.clientWidth / 2;
        const blueRadius = (parseFloat(document.getElementById("circle-blue").style.width) / 100) * container.clientWidth / 2;
        const greenRadius = (parseFloat(document.getElementById("circle-green").style.width) / 100) * container.clientWidth / 2;

        // Send the radius data to the parent Qualtrics page
        const message = {
            redRadius: redRadius,
            blueRadius: blueRadius,
            greenRadius: greenRadius
        };
        window.parent.postMessage(message, "*");

        selectedCircle = null;
        window.removeEventListener("mousemove", onMouseMove);
        window.removeEventListener("mouseup", onMouseUp);
    }

    // Attach event listeners to the circles
    document.querySelectorAll(".circle").forEach((circle) => {
        circle.addEventListener("mousedown", onMouseDown);
    });
</script>

</body>
</html>
